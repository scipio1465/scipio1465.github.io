
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="Follow A Bayesian, Or People Die!" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="postsab/Baysian-conditional-inference/" />
  
<meta property="og:description" content="𝘛𝘩𝘪𝘴 𝘪𝘴 𝘢 𝘸𝘳𝘪𝘵𝘦-𝘶𝘱 𝘰𝘧 𝘴𝘰𝘮𝘦 𝘵𝘩𝘰𝘶𝘨𝘩𝘵𝘴 𝘐 𝘩𝘢𝘥 𝘢𝘵 𝘵𝘩𝘦 𝘣𝘦𝘨𝘪𝘯𝘯𝘪𝘯𝘨 𝘰𝘧 𝘵𝘩𝘦 𝘱𝘢𝘯𝘥𝘦𝘮𝘪𝘤, 𝘭𝘰𝘰𝘬𝘪𝘯𝘨 𝘣𝘢𝘤𝘬 𝘵𝘰 𝘴𝘰𝘮𝘦 𝘢𝘴𝘱𝘦𝘤𝘵𝘴 𝘰𝘧 𝘵𝘩𝘦 𝘍𝘳𝘦𝘲𝘶𝘦𝘯𝘵𝘪𝘴𝘵 𝘷𝘴. 𝘉𝘢𝘺𝘦𝘴𝘪𝘢𝘯 𝘥𝘦𝘣𝘢𝘵𝘦. 𝘐’𝘮 𝘯𝘰𝘵 𝘪𝘯 𝘵𝘩𝘦 𝘱𝘰𝘴𝘪𝘵𝘪𝘰𝘯 𝘵𝘰 𝘢𝘥𝘥 𝘢𝘯𝘺𝘵𝘩𝘪𝘯𝘨 𝘯𝘦𝘸 𝘵𝘰 𝘵𝘩𝘦 𝘵..." />
  
    <title>Follow A Bayesian, Or People Die! &#8212; Non-Abelian Journey</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'postsab/Baysian-conditional-inference';</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about/" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="None"> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../test/atom.xml"
  title="Non-Abelian Journey"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../search/" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">Non-Abelian Journey</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../about/">
                        About me
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../ds_posts/">
                        DS Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../other_posts/">
                        Other Posts
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/scipio1465/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/DrBocci" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/andreab2" title="linkedin" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-linkedin"></i></span>
            <label class="sr-only">linkedin</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://stackoverflow.com/users/10557156/scipio1465" title="StackOverflow" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-stack-overflow"></i></span>
            <label class="sr-only">StackOverflow</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../about/">
                        About me
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../ds_posts/">
                        DS Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../other_posts/">
                        Other Posts
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/scipio1465/" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://twitter.com/DrBocci" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/andreab2" title="linkedin" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-linkedin"></i></span>
            <label class="sr-only">linkedin</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://stackoverflow.com/users/10557156/scipio1465" title="StackOverflow" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fab fa-stack-overflow"></i></span>
            <label class="sr-only">StackOverflow</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">  
<h2>
   <i class="fa fa-calendar"></i>
  26 November 2022 
</h2>

<ul>
   
<li id="author">
  <span
    ><i class="fa-fw fa fa-user"></i></span
  >
   
  <a href="../../test/author/andrea-bocci/">Andrea Bocci</a>  
</li>
   
<li id="category">
  <span
    ><i class="fa-fw fa fa-folder-open"></i></span
  >
   
  <a href="../../test/category/statistics/">statistics</a>  
</li>
 
<li id="tags">
  <span
    ><i class="fa-fw fa fa-tags"></i> </span
  >
   
  <a href="../../test/tag/bayesian/">bayesian</a>   
  <a href="../../test/tag/notebook/">notebook</a>  
</li>
 
<li id="comments">
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = "abocci"; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
      var s = document.createElement("script");
      s.async = true;
      s.type = "text/javascript";
      s.src = "//" + disqus_shortname + ".disqus.com/count.js";
      (
        document.getElementsByTagName("HEAD")[0] ||
        document.getElementsByTagName("BODY")[0]
      ).appendChild(s);
    })();
  </script>
  <i class="fa-fw fa fa-comments"></i>
  <a
    href="#disqus_thread"
    data-disqus-identifier="/postsab/Baysian-conditional-inference/"
  >
    </a
  >
</li>

</ul>

    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../test/category/">Categories</a>
</h3>
<ul>
   
  <li>
    <a href="../../test/category/statistics/">statistics (1)</a>
  </li>
   
</ul>

    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            

            <article class="bd-article" role="main">
               <section class="tex2jax_ignore mathjax_ignore" id="follow-a-bayesian-or-people-die">
<h1>Follow A Bayesian, Or People Die!<a class="headerlink" href="#follow-a-bayesian-or-people-die" title="Permalink to this headline">#</a></h1>
<p>𝘛𝘩𝘪𝘴 𝘪𝘴 𝘢 𝘸𝘳𝘪𝘵𝘦-𝘶𝘱 𝘰𝘧 𝘴𝘰𝘮𝘦 𝘵𝘩𝘰𝘶𝘨𝘩𝘵𝘴 𝘐 𝘩𝘢𝘥 𝘢𝘵 𝘵𝘩𝘦 𝘣𝘦𝘨𝘪𝘯𝘯𝘪𝘯𝘨 𝘰𝘧 𝘵𝘩𝘦 𝘱𝘢𝘯𝘥𝘦𝘮𝘪𝘤, 𝘭𝘰𝘰𝘬𝘪𝘯𝘨 𝘣𝘢𝘤𝘬 𝘵𝘰 𝘴𝘰𝘮𝘦 𝘢𝘴𝘱𝘦𝘤𝘵𝘴 𝘰𝘧 𝘵𝘩𝘦 𝘍𝘳𝘦𝘲𝘶𝘦𝘯𝘵𝘪𝘴𝘵 𝘷𝘴. 𝘉𝘢𝘺𝘦𝘴𝘪𝘢𝘯 𝘥𝘦𝘣𝘢𝘵𝘦. 𝘐’𝘮 𝘯𝘰𝘵 𝘪𝘯 𝘵𝘩𝘦 𝘱𝘰𝘴𝘪𝘵𝘪𝘰𝘯 𝘵𝘰 𝘢𝘥𝘥 𝘢𝘯𝘺𝘵𝘩𝘪𝘯𝘨 𝘯𝘦𝘸 𝘵𝘰 𝘵𝘩𝘦 𝘵𝘰𝘱𝘪𝘤, 𝘣𝘶𝘵 𝘐 𝘸𝘪𝘭𝘭 𝘶𝘴𝘦 𝘵𝘩𝘦 𝘯𝘦𝘸𝘴 𝘰𝘧 𝘵𝘩𝘢𝘵 𝘵𝘪𝘮𝘦 𝘵𝘰 𝘨𝘪𝘷𝘦 𝘢𝘯 𝘦𝘹𝘢𝘮𝘱𝘭𝘦 𝘸𝘩𝘦𝘳𝘦 𝘍𝘳𝘦𝘲𝘶𝘦𝘯𝘵𝘪𝘴𝘵 𝘢𝘯𝘥 𝘉𝘢𝘺𝘦𝘴𝘪𝘢𝘯 𝘨𝘪𝘷𝘦 𝘥𝘪𝘧𝘧𝘦𝘳𝘦𝘯𝘵 𝘢𝘯𝘴𝘸𝘦𝘳𝘴. 𝘐𝘵 𝘪𝘴 𝘢 𝘤𝘭𝘢𝘴𝘴𝘪𝘤 𝘤𝘰𝘯𝘥𝘪𝘵𝘪𝘰𝘯𝘢𝘭 𝘴𝘵𝘢𝘵𝘪𝘴𝘵𝘪𝘤𝘢𝘭 𝘪𝘯𝘧𝘦𝘳𝘦𝘯𝘤𝘦, 𝘦𝘢𝘴𝘺 𝘪𝘧 𝘺𝘰𝘶 𝘩𝘢𝘷𝘦 𝘢 𝘥𝘦𝘦𝘱 𝘶𝘯𝘥𝘦𝘳𝘴𝘵𝘢𝘯𝘥𝘪𝘯𝘨 𝘰𝘧 𝘵𝘩𝘦 𝘥𝘪𝘧𝘧𝘦𝘳𝘦𝘯𝘤𝘦𝘴 𝘣𝘦𝘵𝘸𝘦𝘦𝘯 𝘍𝘳𝘦𝘲𝘶𝘦𝘯𝘵𝘪𝘴𝘵 𝘢𝘯𝘥 𝘉𝘢𝘺𝘦𝘴𝘪𝘢𝘯 𝘴𝘵𝘢𝘵𝘪𝘴𝘵𝘪𝘤𝘴, 𝘣𝘶𝘵 𝘢𝘭𝘴𝘰 𝘦𝘢𝘴𝘺 𝘵𝘰 𝘨𝘰 𝘸𝘳𝘰𝘯𝘨 𝘪𝘧 𝘺𝘰𝘶 𝘥𝘰𝘯’𝘵.</p>
<hr class="docutils" />
<aside class="sidebar">
<p><img alt="" src="../../_images/few_good_man.png" /></p>
</aside>
<p>The title is inspired by a quote from Col. Jessup (interpreted by Jack Nicholson) in <em>A Few Good Man</em> movie.</p>
<p><em>“We follow orders, son.<br />
We follow orders or people die.<br />
It’s that simple.”</em></p>
<p>A truly legendary performance!</p>
</br>
</br><hr class="docutils" />
<div class="admonition-disclaimer admonition">
<p class="admonition-title"><em>Disclaimer</em></p>
<p>Despite the provocative title, and how sometimes the Frequentist approach to these kind of problems is mis-represented in many accounts you find on the web (too many unfortunately of low quality, try to Google it!), <u> <em>I do not advocate the view that Frequentist is bad and you should always use Bayesian!</em> </u>.</p>
<p>The usual advice is to <strong>always choose wisely</strong> (obviously!).<br />
My goal is to persuade you that in order to do so <u> <strong>you must understand both well!</strong> </u>(that’s the real trick!).</p>
</div>
<div class="admonition-disclaimer-2 admonition">
<p class="admonition-title"><em>Disclaimer 2</em></p>
<p>For a deep, practical  and very well done discussion on this topic I strongly suggest to have a look at what <a class="reference external" href="http://jakevdp.github.io/blog/2014/03/11/frequentism-and-bayesianism-a-practical-intro/">Jake VanderPlas has written in his blog</a>. Here I followed his approach in presenting these kind of problems.</p>
</div>
<hr class="docutils" />
<section id="issues-with-early-covid-19-samples">
<h2>Issues With Early Covid-19 Samples<a class="headerlink" href="#issues-with-early-covid-19-samples" title="Permalink to this headline">#</a></h2>
<p>At the beginning of the pandemic (Feb-Mar 2020) we knew very little about this new disease and, above all, how extended was  spread and how deadly it was. The only available information, repeated tirelessly by the media, were about the number and fraction of people tested positive, how many of them needed hospitalization and, unfortunately, the number of deaths.</p>
<p>What added even more rage for people like me that digest data for a living, was the mis-use and mis-interpretation of those numbers and figures. Both by traditional media and, exponentially magnified, by the totally uncontrolled arena of social media.</p>
<p>In fact, it was clear to anybody with minimal statistic background that all the extrapolations about the spread, seriousness, death rate, etc…  of the disease (<em>statistic inference</em> in our jargon) from the <em>daily</em> rate of infection announcements (as the number positives over the total tests done) was <strong>completely meaningless</strong> and totally biased.</p>
<p>What it was needed - as many pointed out -  was a <strong>controlled testing on a randomly selected sample of people</strong>. Unfortunately at that time it was not possible to do it. The limited supply of testing kits that were prioritized to key workers and people with symptoms. That was totally understandable.</p>
<p>But the inability to produce unbiased data was not a justification to use biased data as an alternative!!</p>
<p>However <u><strong>there was an important exception to this lack of unbiased data:</strong></u> the <a class="reference external" href="https://en.wikipedia.org/wiki/COVID-19_pandemic_on_cruise_ships">Diamond Princess cruise ship</a> (and others later).</p>
<p>Because of the isolated environment and relatively low number, <strong>all</strong> passengers were tested <em>independently from the fact they reported symptoms or not</em>.</p>
<p>For some time, the data from cruise ships have been the only unbiased ones available. Many scientists used these data for early studies of the Covid-19 (i.e. <a class="reference external" href="https://www.nature.com/articles/d41586-020-00885-w">“What the cruise-ship outbreaks reveal about COVID-19”</a> published in <em>Nature</em> on  26 March 2020)</p>
</section>
<section id="a-statistical-problem-on-conditional-inference">
<h2>A Statistical Problem on Conditional Inference<a class="headerlink" href="#a-statistical-problem-on-conditional-inference" title="Permalink to this headline">#</a></h2>
<p>Those dramatic events at early stage of the pandemic reminded me examples of <strong>conditional inferences</strong>, an advanced statistical concept. They are fairly well known,  with first examples dating back to the reverend Thomas Bayes in 1763, that  discussed a “billiard problem” <a class="reference external" href="https://en.wikipedia.org/wiki/An_Essay_towards_solving_a_Problem_in_the_Doctrine_of_Chances">in his paper</a>.</p>
<p>Almost any book on Statistics has a version of these kind of problems, and for a good reason! They really challenge your understanding of statistical inference, and make you appreciate the subtleties behind the Frequentist and Bayesian approach to probability.</p>
<p>It is <strong>only after</strong> a full understanding of these subtleties that you can really be in a position to <strong>“choose wisely</strong>”!</p>
<div class="topic">
<p class="topic-title">A Covid-19 Infected Cruise Ship Problem</p>
<p>A cruise ship docked on the port you are responsible for. They have reported people with Covid-19 symptoms. All passengers have being tested, and you have to dispatch ambulances to take people tested positive in dedicated hubs for treatment.</p>
<p>You assess the situation as the following:</p>
<ul class="simple">
<li><p>So far M=35 passengers got their Covid-19 test results, with Q=7 tested positive.</p></li>
<li><p>They have been already disembarked and taken care accordingly</p></li>
<li><p>There are still N=70 people on board, with the  Covid-19 test results still pending.</p></li>
<li><p>You only have K=22 ambulances left.</p></li>
<li><p>One ambulance can carry only one positive passenger.</p></li>
</ul>
<p>At this point you get a call from the crisis center headquarter asking you if you need more ambulances. They explain that ambulances are needed everywhere and this will be your only chance to have more ambulances. However you should only ask what is deemed necessary, many people lives are at stake.</p>
<p>Clearly to be 100% safe, you should have 70 ambulances; you will be covered no matter what.</p>
<p>But ambulances are scarce, so you decide to take a reasonable risk:  <em>you will ask for more ambulances only if the probability that 22 ambulances are not enough is higher than 10%</em></p>
<p>What you should answer then?</p>
<p><strong>Will the number of positive tests on the remaining 70 passengers be greater than 22 with a probability higher than 10% ?</strong></p>
</div>
</section>
<section id="some-possible-answers">
<h2>Some possible answers<a class="headerlink" href="#some-possible-answers" title="Permalink to this headline">#</a></h2>
<p>There are many ways to reason about this problem, I will discuss four of them:</p>
<dl class="myst field-list simple">
<dt class="field-odd">Frequentist Approach</dt>
<dd class="field-odd"><p>This is how a Frequentist <em>might</em> answer</p>
</dd>
<dt class="field-even">Bayesian Approach</dt>
<dd class="field-even"><p>This is how a  Bayesian <em>will</em> probbably answer</p>
</dd>
<dt class="field-odd">Professional Approach</dt>
<dd class="field-odd"><p>This is how a Professional statistician  <em>may</em> answer</p>
</dd>
<dt class="field-even">Caveman Approach</dt>
<dd class="field-even"><p>This is how a person knowing nothing or enough about conditional probability, maximum likelihood, nuisance parameters, Beta-Binomial distribution, etc… , but with very good coding skills, <em>might</em> answer. A DevOps or MLOps engineer for example.</p>
</dd>
</dl>
<p>In the following  we assume the first 35 people were randomly selected, <em>i.e.</em> their rate of infection is the same as the remaining 70 passengers (<em>never ever ever</em> give priority to woman, children or elderly as a statistician,it will totally bias your sample!!).</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="key1" for="sd-tab-item-0">
Frequentist</label><div class="sd-tab-content docutils">
<p>A frequentistic approach could go like this:</p>
<ul class="simple">
<li><p>The actual (true) infection rate is <span class="math notranslate nohighlight">\(\rho\)</span>. We don’t know it, but we can infer our best guess by the measurements we have.</p></li>
<li><p>For any given passenger already tested, we can calculate the probability (binomial) distribution of the observation (positive or not), given <span class="math notranslate nohighlight">\(\rho\)</span>.</p></li>
<li><p>As we have <span class="math notranslate nohighlight">\(M=35\)</span> observations, we  can calculate the <em>likelihood</em> <span class="math notranslate nohighlight">\(\mathcal{L}(\rho)\)</span> of observing <span class="math notranslate nohighlight">\(Q=7\)</span> positives as join probability of <span class="math notranslate nohighlight">\(M\)</span> independent observations</p></li>
<li><p>Finally we calculate which value of <span class="math notranslate nohighlight">\(\rho\)</span> maximize the <em>likelihood</em> <span class="math notranslate nohighlight">\(\mathcal{L}(\rho)\)</span>  of observing the measurements we observe. That result <span class="math notranslate nohighlight">\(\hat{\rho}\)</span> is our best guess for <span class="math notranslate nohighlight">\(\rho\)</span>.</p></li>
</ul>
<p>After all those steps and calculations we find that our best guess <span class="math notranslate nohighlight">\(\hat{\rho}\)</span> is (surprise!):</p>
<div class="math notranslate nohighlight">
\[ \hat{\rho} = \frac{Q}{M} = \frac{7}{35} \]</div>
<p>Since the infection rate is the same for all passengers, the probability of <span class="math notranslate nohighlight">\(K\)</span> positive cases out of the remaining <span class="math notranslate nohighlight">\(N\)</span> passengers is easy to calculate (binomial probability):</p>
<div class="math notranslate nohighlight">
\[ P(K|N,M,Q) = \hat{\rho}^K (1-\hat{\rho})^{N-K}  = \bigg(\frac{Q}{M}\bigg)^K \bigg(1-\frac{Q}{M}\bigg)^{N-K} = \frac{Q^K}{M^N}(M-Q)^{N-K}  \]</div>
<p>In particular we want to know the overall probability <span class="math notranslate nohighlight">\(\mathcal{P}(K_{max})\)</span> that the number of positive cases is above <span class="math notranslate nohighlight">\(K_{max} = 22\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}(K_{max}) = \sum_{K &gt; K_{max}} P_{K}  \]</div>
<p>If  <span class="math notranslate nohighlight">\(\mathcal{P}(K_{max})\)</span> is above 10% the risk is too high, and we need more ambulances.</p>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="key2" for="sd-tab-item-1">
Bayesian</label><div class="sd-tab-content docutils">
<p>A bayesian will treat this problem as a simple case of <strong>conditional probability with a nuisance parameter to <em>marginalize</em></strong></p>
<p>Let’s define for clarity:</p>
<dl class="myst field-list simple">
<dt class="field-odd">A</dt>
<dd class="field-odd"><p>there are <span class="math notranslate nohighlight">\(K\)</span> positive  cases among the <span class="math notranslate nohighlight">\(N=70\)</span> passenger on board</p>
</dd>
<dt class="field-even">D</dt>
<dd class="field-even"><p>the data we have, <em>i.e.</em> there are <span class="math notranslate nohighlight">\(Q=7\)</span> positive cases among the <span class="math notranslate nohighlight">\(M=35\)</span> passengers already tested</p>
</dd>
<dt class="field-odd"><span class="math notranslate nohighlight">\(\rho\)</span></dt>
<dd class="field-odd"><p>the unknown infection rate</p>
</dd>
</dl>
<p>What we want is <span class="math notranslate nohighlight">\(P(A,\rho|D)\)</span>, and since <span class="math notranslate nohighlight">\(\rho\)</span> is unknown, it is marginalized:</p>
<div class="math notranslate nohighlight">
\[
P(A|D) = \int{P(A,\rho|D)d\rho}
\]</div>
<p>The trick now is to manipulate this expression until we get something we know how to calculate. Using the law of conditional probability (<span class="math notranslate nohighlight">\(P(A\cap B) = P(A|B) \cdot P(B)\)</span>) and the Bayes’ theorem we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P(A,\rho|D) = P(A|\rho, D)\cdot P(\rho|D) \\
P(\rho|D) = \frac{P(D|\rho) \cdot P(\rho)}{p(D)}\\
P(D) = \int{P(D|\rho) \cdot P(\rho)\ d\rho}
\end{split}\]</div>
<p>Using the binomial probability, we also have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
P(A|\rho, D)  =  {K \choose N} {\rho}^K (1-{\rho})^{N-K} \\
P(D|\rho) = {Q \choose M} {\rho}^Q (1-{\rho})^{M-Q}
\end{split}\]</div>
<p>The last bit is what to put for <span class="math notranslate nohighlight">\(P(\rho)\)</span>, the <em>prior</em> on the probability distribution of <span class="math notranslate nohighlight">\(\rho\)</span>. What we can say is that it can be equally anything  between 0 and 1 (flat distribution, <span class="math notranslate nohighlight">\(P(\rho)=c\)</span>). Put everything together:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \begin{align}
      P(A|D) &amp; = \int{P(A,\rho|D)d\rho} = \int{P(A|\rho, D)   \cdot P(\rho|D)  \   d\rho}   \\
             &amp; = \int{P(A|\rho, D)   \cdot \frac{P(D|\rho) \cdot P(\rho)}{p(D)}  \   d\rho} \\
             &amp; = \frac{\int{P(A|\rho, D)   \cdot P(D|\rho) \cdot P(\rho)  \   d\rho}}{\int{P(D|\rho) \cdot P(\rho)  \   d\rho}} \\
             &amp; =  {K \choose N} \frac{\int_0^1{\rho^K (1-\rho)^{N-K} \cdot \rho^Q (1-\rho)^{M-Q} d\rho}}{\int_0^1{{\rho}^Q (1-{\rho})^{M-Q} \   d\rho}}
   \end{align}
\end{split}\]</div>
<p>After calculating these simple integrals, we get the conditional probability to observe <span class="math notranslate nohighlight">\(K\)</span> positives on the remaining passengers:</p>
<div class="math notranslate nohighlight">
\[
P(A|D) = P(K|N,M,Q) = {K \choose N} \frac{(K+Q)!}{Q!} \cdot
\frac{(N-K+(M-Q))! }{(N+M+1)} \cdot
\frac{(M+1)!}{(M-Q)!}
\]</div>
<p>We can get the overall probability <span class="math notranslate nohighlight">\(\mathcal{P}(K_{max})\)</span> that the number of positive cases is above <span class="math notranslate nohighlight">\(K_{max} = 22\)</span> from :</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}(K_{max}) = \sum_{K = K_{max}+1}^N P(K|N,M,Q)  \]</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="key4" for="sd-tab-item-2">
Professional</label><div class="sd-tab-content docutils">
<p>A Professional would recognize that he probability of <span class="math notranslate nohighlight">\(a\)</span> positives in <span class="math notranslate nohighlight">\(A\)</span> passengers randomly selected from all the <span class="math notranslate nohighlight">\(B\)</span> passengers among which there are exactly <span class="math notranslate nohighlight">\(b\)</span> positives follows a  <strong>Hypergeometric distribution</strong>, i.e.:</p>
<div class="math notranslate nohighlight">
\[
p(a|b,B,A) =  \mathcal{HG}(a|b,B,A)
\]</div>
<p>In this problem however we know <span class="math notranslate nohighlight">\(a\)</span> and with this information we want, on the still-to-be-tested passengers (<span class="math notranslate nohighlight">\(B-A\)</span>), the distribution of the number of positives still unknown (<span class="math notranslate nohighlight">\(b-a\)</span>)</p>
<p>It is convenient to choose for <span class="math notranslate nohighlight">\(b\)</span> a <strong>Beta-Binomial distribution</strong> as <em>prior</em>, as it is a <em>conjugate prior</em> of a Hypergeometric distribution:</p>
<div class="math notranslate nohighlight">
\[
b \approx \mathcal{BB}(b|B,\alpha,\beta)
\]</div>
<p>This implies that the unknown number of positives <span class="math notranslate nohighlight">\(b-a\)</span> is also a Beta-Binomial distribution (<em>posterior</em>):</p>
<div class="math notranslate nohighlight">
\[
b-a \approx \mathcal{BB}(b-a|B-A,\alpha+a,\beta+(A-a))
\]</div>
<p>where the hyperparameters <span class="math notranslate nohighlight">\(\alpha,\beta\)</span> of the prior are added to the observed numbers of positives and negatives passengers <span class="math notranslate nohighlight">\(a, A-a\)</span>.</p>
<p>Using the notation of the problem (<span class="math notranslate nohighlight">\(A=M, a=Q, B=N+M, b=K+Q\)</span>) and choosing a uniform prior (<span class="math notranslate nohighlight">\(\alpha = \beta = 1\)</span>):</p>
<div class="math notranslate nohighlight">
\[
P(K|N,M,Q) = \mathcal{BB}(K, N, Q+1, M-Q+1)
\]</div>
<p>We can get the overall probability <span class="math notranslate nohighlight">\(\mathcal{P}(K_{max})\)</span> that the number of positive cases is above <span class="math notranslate nohighlight">\(K_{max} = 22\)</span> from :</p>
<div class="math notranslate nohighlight">
\[\mathcal{P}(K_{max}) = \sum_{K = K_{max}+1}^N P(K|N,M,Q)  \]</div>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="key3" for="sd-tab-item-3">
Caveman</label><div class="sd-tab-content docutils">
<p>A caveman would just write a simple <strong>toy Monte Carlo simulation</strong>, for example as follow:</p>
<ul class="simple">
<li><p>Assume a random infection rate,</p></li>
<li><p>Create a random, <em>fake</em> scenario of infected passengers in agreement with the given observations,</p></li>
<li><p>Simply annotate (yes or no) if that scenario has an “unwanted” outcome, i.e. the number of tested positives passengers are more than 22</p></li>
<li><p>Generate zillion of scenarios</p></li>
</ul>
<p>In the end, the fraction of the generated scenarios with an “unwanted” outcome will give the probability required. No statistic knowledge needed, just a ratio of two integers.</p>
</div>
</div>
<details class="sd-sphinx-override sd-dropdown sd-card sd-m-auto sd-fade-in-slide-down">
<summary class="sd-summary-title sd-card-header sd-bg-success sd-bg-text-success">
<span class="sd-summary-icon"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-code" viewBox="0 0 16 16" aria-hidden="true"><path fill-rule="evenodd" d="M4.72 3.22a.75.75 0 011.06 1.06L2.06 8l3.72 3.72a.75.75 0 11-1.06 1.06L.47 8.53a.75.75 0 010-1.06l4.25-4.25zm6.56 0a.75.75 0 10-1.06 1.06L13.94 8l-3.72 3.72a.75.75 0 101.06 1.06l4.25-4.25a.75.75 0 000-1.06l-4.25-4.25z"></path></svg></span>Python Code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="key1" for="sd-tab-item-4">
Frequentist</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span> <span class="k">as</span> <span class="n">f_</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1">## P(K|N,M,Q)</span>
<span class="k">def</span> <span class="nf">FreqProbability</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
    
    <span class="n">p_hat</span> <span class="o">=</span> <span class="n">q</span><span class="o">/</span><span class="n">m</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">p_hat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prob</span>

<span class="c1">## P(K_max)</span>
<span class="k">def</span> <span class="nf">ProbabilitySum</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">k_max</span> <span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
    <span class="n">prob_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_max</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="c1">#print(prob_v)</span>
    <span class="k">return</span> <span class="n">prob_v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">k_max</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">p_max</span> <span class="o">=</span> <span class="n">ProbabilitySum</span><span class="p">(</span><span class="n">FreqProbability</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total probability for K_max=</span><span class="si">{</span><span class="n">k_max</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">p_max</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="key2" for="sd-tab-item-5">
Bayesian</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span> <span class="k">as</span> <span class="n">f_</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>


<span class="c1">## integral value</span>
<span class="k">def</span> <span class="nf">ProbIntegralValue</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f_</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">f_</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">f_</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">BayesianProbability</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">q</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">m</span><span class="o">-</span><span class="n">a</span>
    <span class="n">den</span> <span class="o">=</span> <span class="n">ProbIntegralValue</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    
    <span class="n">a</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="n">q</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">-</span><span class="n">a</span>
    <span class="n">num</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">ProbIntegralValue</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">num</span><span class="o">/</span><span class="n">den</span>

<span class="c1">## P(K_max)</span>
<span class="k">def</span> <span class="nf">ProbabilitySum</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">k_max</span> <span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>
    <span class="n">prob_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_max</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="c1">#print(prob_v)</span>
    <span class="k">return</span> <span class="n">prob_v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="n">k_max</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">p_max</span> <span class="o">=</span> <span class="n">ProbabilitySum</span><span class="p">(</span><span class="n">BayesianProbability</span><span class="p">,</span> <span class="n">k_max</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total probability for K_max=</span><span class="si">{</span><span class="n">k_max</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">p_max</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="key4" for="sd-tab-item-6">
Professional</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">betabinom</span>

<span class="c1">##- Input</span>
<span class="n">m</span><span class="o">=</span><span class="mi">35</span>
<span class="n">q</span><span class="o">=</span><span class="mi">7</span>
<span class="n">n</span><span class="o">=</span><span class="mi">70</span>
<span class="n">k</span><span class="o">=</span><span class="mi">22</span>

<span class="c1">## Use the sf = 1-cdf to have the overall probability</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">betabinom</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total probability for K_max=</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1"> &#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="key3" for="sd-tab-item-7">
Caveman</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">MakeExperiment</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="c1">## make a random scenario of N tosses with probability p</span>
    <span class="n">rnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">rnd</span><span class="o">&lt;</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1">## 1 with probability p, 0 with probability (1-p)</span>
    
<span class="k">def</span> <span class="nf">CheckExperiment</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">observed_tosses</span><span class="p">,</span> <span class="n">positive_observed</span><span class="p">,</span> <span class="n">check_type</span> <span class="o">=</span> <span class="s1">&#39;measurement&#39;</span><span class="p">):</span>
    <span class="c1">## check if a given experiment satisfy requirements:</span>
    <span class="c1">## check_type = &#39;measurement&#39;</span>
    <span class="c1">##          Requirement: having &#39;positive_observed&#39; in the first &#39;observed_tosses&#39; tosses</span>
    <span class="c1">## check_type = &#39;expectation&#39;</span>
    <span class="c1">##          Requirement: having &#39;positive_observed&#39; in the tosses after the first &#39;observed_tosses&#39;</span>
    <span class="c1">#print(experiment, observed_tosses, positive_observed, check_type)</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">observed_tosses</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">observed_tosses</span> <span class="o">&gt;=</span> <span class="n">positive_observed</span><span class="p">)</span>

    <span class="n">test_passed</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="c1">## positives in observed</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">check_type</span> <span class="o">==</span> <span class="s1">&#39;measurement&#39;</span><span class="p">):</span>
        <span class="n">positives</span> <span class="o">=</span> <span class="n">experiment</span><span class="p">[:</span><span class="n">observed_tosses</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">positives</span> <span class="o">==</span> <span class="n">positive_observed</span><span class="p">:</span> <span class="n">test_passed</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1">## positive in not-observed</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">check_type</span> <span class="o">==</span> <span class="s1">&#39;expectation&#39;</span><span class="p">):</span>
        <span class="n">positives</span> <span class="o">=</span> <span class="n">experiment</span><span class="p">[</span><span class="n">observed_tosses</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">positives</span> <span class="o">&gt;</span> <span class="n">positive_observed</span><span class="p">:</span> <span class="n">test_passed</span> <span class="o">=</span> <span class="kc">True</span>
        
    <span class="k">if</span> <span class="n">test_passed</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">experiment</span>
    
    <span class="k">return</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">RunSimulation</span><span class="p">(</span><span class="n">Tot_number_experiments</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="n">N_experiment_accepted</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">N_experiment_sucessed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Tot_number_experiments</span><span class="p">):</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="c1">## random p    </span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="n">CheckExperiment</span><span class="p">(</span><span class="n">MakeExperiment</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">m</span><span class="p">,</span><span class="n">p</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="c1"># Make experiment compatible with observation</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># if not passing the check, move on</span>
        <span class="n">N_experiment_accepted</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">good_experiment</span> <span class="o">=</span> <span class="n">CheckExperiment</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">check_type</span> <span class="o">=</span> <span class="s1">&#39;expectation&#39;</span><span class="p">)</span> <span class="c1">## Now check if compatible with expectations</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">good_experiment</span><span class="p">):</span> <span class="n">N_experiment_sucessed</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;... experiment done&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">N_experiment_accepted</span><span class="p">,</span> <span class="n">N_experiment_sucessed</span><span class="p">])</span>
    


<span class="c1">## Observed </span>
<span class="n">observed_tosses</span> <span class="o">=</span> <span class="mi">35</span> 
<span class="n">positive_in_observed</span> <span class="o">=</span> <span class="mi">7</span>
<span class="c1">## To predict</span>
<span class="n">future_tosses</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">positive_in_future</span> <span class="o">=</span> <span class="mi">22</span>
<span class="c1">## Number of simulated experiments</span>
<span class="n">Tot_number_experiments</span> <span class="o">=</span> <span class="mi">10000000</span>

<span class="c1">###-----</span>
<span class="n">n_bunches</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">## split in bunches to estimate the error</span>
<span class="n">N_in_bunch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Tot_number_experiments</span><span class="o">/</span><span class="n">n_bunches</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">RunSimulation</span><span class="p">(</span><span class="n">N_in_bunch</span><span class="p">,</span> <span class="n">future_tosses</span><span class="p">,</span> <span class="n">observed_tosses</span><span class="p">,</span> <span class="n">positive_in_future</span><span class="p">,</span> <span class="n">positive_in_observed</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bunches</span><span class="p">)])</span>

<span class="c1">## With error estimate</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">result</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probability of </span><span class="si">{}</span><span class="s2"> positive in next </span><span class="si">{}</span><span class="s2"> tosses after observing </span><span class="si">{}</span><span class="s2"> positives in </span><span class="si">{}</span><span class="s2"> tosses: (</span><span class="si">{:.5f}</span><span class="s2"> +- </span><span class="si">{:.5f}</span><span class="s2">) %&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> \
    <span class="n">positive_in_future</span><span class="p">,</span> <span class="n">future_tosses</span><span class="p">,</span> <span class="n">positive_in_observed</span><span class="p">,</span> <span class="n">observed_tosses</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span> <span class="p">))</span>

</pre></div>
</div>
</div>
</div>
</div>
</details><section id="results">
<h3>Results<a class="headerlink" href="#results" title="Permalink to this headline">#</a></h3>
<p>Running the Python code we can report the final answers</p>
<p><strong>Will the number of positive tests on the remaining 70 passengers be higher than 22 with 10% (or more) probability?</strong></p>
<dl class="myst field-list simple">
<dt class="field-odd">Frequentist</dt>
<dd class="field-odd"><p><strong>NO</strong>. The probability is only 0.8%</p>
</dd>
<dt class="field-even">Bayesian</dt>
<dd class="field-even"><p><strong>YES</strong>. The probability is 10.92%</p>
</dd>
<dt class="field-odd">Professional</dt>
<dd class="field-odd"><p><strong>YES</strong>. The probability is 10.92%</p>
</dd>
<dt class="field-even">Caveman</dt>
<dd class="field-even"><p><strong>YES</strong>. The probability is (10.92 <span class="math notranslate nohighlight">\(\pm\)</span> 0.14) %</p>
</dd>
</dl>
<p>The Caveman result accounts for the statistical error on the number of toy Montecarlo generated while the other three approaches are analytical results.</p>
<p>But these are just details.</p>
<p>The main point is that the Frequentist approach gives the <strong>wrong</strong> answer, and as a consequence people die! (well, to be precise there is a 10.92% probability that nobody dies)</p>
</section>
</section>
<section id="discussion-and-take-away-message">
<h2>Discussion and Take Away Message<a class="headerlink" href="#discussion-and-take-away-message" title="Permalink to this headline">#</a></h2>
<p>OK, what’s going on here?? Were not all those endless frequentistic vs. bayesian debates basically all but philosophical banters? Some pedantic interpretations of the concept of probability but basically giving identical answers in all practical cases? And this is why it is important not only to know them, but also to understand them well.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Frequentistic and Bayesian <strong>never give the same answers</strong> (maybe the same results), for the simple fact that <strong>they don’t answer the same question</strong>!</p>
</div>
<section id="is-the-frequentistic-statistical-inference-all-wrong">
<h3>Is the frequentistic statistical inference all wrong?<a class="headerlink" href="#is-the-frequentistic-statistical-inference-all-wrong" title="Permalink to this headline">#</a></h3>
<p>Is this a counterexample that the frequentist approach is wrong? Obviously not!</p>
<p>Any person with a good statistic background already realized from the start that the frequentist approach I showed above is not what a frequentist would do.</p>
<p>To explain well why is beyond the scope of this post (this is also the reason for the immense literature on these topics!). But I will put here few points that are important to have crystal clear for a proper application of statistic inference, whatever approach one might use:</p>
<ul class="simple">
<li><p>A Frequentist would already have argued about the question asked. The objection is on the meaning of <em>“90% probability that at most 22 passengers on board will test positive”</em>. For a frequentist there is not such a probability. Either it will happen or it will not. That’s the truth. We don’t know what it will be, but there is not 11% or 0.8% or whatever probability. It is yes or it is no.</p></li>
<li><p>In any case, a Frequentist  would probably have framed the problem in term of hypothesis testing, and/or confident interval. But this <strong>IS NOT</strong> the same as the  Bayesian counterparts (often called <em>credible region</em>). They are <strong>NOT</strong> answering the same question!</p></li>
<li><p>The freqentist inference gives procedures on statistics problems. They account of observations in the calculation of the confidence interval, but the statistic interpretation is on the <em>procedure</em>. The <em>procedure</em> does come with a frequency guarantee that the truth number of positives is within the frequentist confidence interval 95% of the time (or whatever threshold is used), not the particular confidence interval.</p></li>
<li><p>If the frequentist procedure is applied to 100 cruise ships in the same situation, for 95 ships the calculated confident interval contains the true value of positive passengers. If you consider only 1 ship though , it may be one of those 95 or one of the remaining 5. In the latter case the calculated confidence interval <strong>DOES NOT</strong> contain the true value. As for the frequentist spirit, the truth is or is not in the calculated interval, there is no probability.</p></li>
<li><p>In this sense <em>conditional</em> inference is  not Frequentist. Confidence Intervals are <em>un</em>-conditional.</p></li>
</ul>
<p>As a final note, it seems in this particular case the Bayesian approach is a better (in the sense of “more intuitive”) choice. But I still remember a warning I once found somewhere while reading about these topics:</p>
<blockquote class="epigraph">
<div><p>To those who attach themselves to either camp: remember, there is plenty of ammunitions in term of counterexamples on <strong>BOTH</strong> sides!</p>
</div></blockquote>
</section>
</section>
</section>

<div class="section">
    

<div class="section">
  <span style="float: left">
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
    
  </span>
</div>
  
  <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = "abocci";
      var disqus_identifier = "/postsab/Baysian-conditional-inference/";
      var disqus_title = "Follow A Bayesian, Or People Die!";
      var disqus_url = "https://scipio1465.github.io/postsab/Baysian-conditional-inference";

      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="https://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </div>
  
</div>

            </article>
            
<!-- Add a comment box underneath the page's content -->
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://abocci.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#issues-with-early-covid-19-samples">
   Issues With Early Covid-19 Samples
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-statistical-problem-on-conditional-inference">
   A Statistical Problem on Conditional Inference
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-possible-answers">
   Some possible answers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#results">
     Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion-and-take-away-message">
   Discussion and Take Away Message
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#is-the-frequentistic-statistical-inference-all-wrong">
     Is the frequentistic statistical inference all wrong?
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, Andrea Bocci.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>