
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta property="og:title" content="Setup" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="postsab/newdir/ProustSummary/" />
  
<meta property="og:description" content="FIles content: proust3: la prigioniera, tutto in paper, proust4: la fuggitiva, tutto in ebook, Proust: un po’ nome dei paesi Vol2, merged for all others. To do: sistemare proust2, creare generatore..." />
  
    <title>Setup &#8212; Non-Abelian Journey</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'postsab/newdir/ProustSummary';</script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../../about/" />
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="None">  
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fas fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../../">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">Non-Abelian Journey</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../../about/">
                        About me
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../ds_posts/">
                        DS Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../other_posts/">
                        Other Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../test/">
                        test
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/scipio1465/" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://twitter.com/DrBocci" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/andreab2" title="linkedin" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-linkedin"></i></span>
            <label class="sr-only">linkedin</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://stackoverflow.com/users/10557156/scipio1465" title="StackOverflow" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-stack-overflow"></i></span>
            <label class="sr-only">StackOverflow</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fas fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../../../about/">
                        About me
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../ds_posts/">
                        DS Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../other_posts/">
                        Other Posts
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../../../test/">
                        test
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/scipio1465/" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://twitter.com/DrBocci" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/andreab2" title="linkedin" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-linkedin"></i></span>
            <label class="sr-only">linkedin</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://stackoverflow.com/users/10557156/scipio1465" title="StackOverflow" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-stack-overflow"></i></span>
            <label class="sr-only">StackOverflow</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
    </div>
    <div class="sidebar-start-items__item">
<h3>
  <a href="../../../test/category/">Categories</a>
</h3>
<ul>
   
  <li>
    <a href="../../../test/category/cat1/">cat1 (1)</a>
  </li>
    
  <li>
    <a href="../../../test/category/cat2/">cat2 (1)</a>
  </li>
    
  <li>
    <a href="../../../test/category/notebook_ab/">notebook_ab (1)</a>
  </li>
    
  <li>
    <a href="../../../test/category/test/">test (1)</a>
  </li>
   
</ul>

    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            

            <article class="bd-article" role="main">
               <div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;/content/drive&quot;</span><span class="p">)</span>
<span class="c1">## now the authentication is required.  It will require username and passwd, so you can use a different account</span>
<span class="c1">##  4/1AX4XfWjdcQKolL3mXr_ejyAko40f4i2heA10soH6ZNL_1nJN64sxbpJEdGc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls -Al drive/MyDrive/Datasets/
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 92
-rw------- 1 root root  5075 Aug  4 18:40 proust01.txt
-rw------- 1 root root  3358 Aug  5 09:56 proust02.txt
-rw------- 1 root root  4238 Aug  5 11:14 proust03.txt
-rw------- 1 root root  5380 Aug  5 12:52 proust04.txt
-rw------- 1 root root  2704 Aug  5 13:52 proust05.csv
-rw------- 1 root root  2816 Aug  5 12:54 proust05p.txt
-rw------- 1 root root   896 Aug  5 13:46 proust06e.csv
-rw------- 1 root root  1006 Aug  5 13:02 proust06e.txt
-rw------- 1 root root  1431 Aug 31 20:01 proust07.csv
-rw------- 1 root root  1419 Aug 31 20:00 proust7p_tmp.txt
-rw------- 1 root root   404 Aug 31 20:09 proust_meta_uptovol6.csv
-rw------- 1 root root   403 Aug 31 20:16 proust_meta_uptovol7.csv
-rw------- 1 root root 28281 Aug 28 16:53 proust_uptovol6.csv
-rw------- 1 root root 33332 Aug 31 20:04 proust_uptovol7.csv
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;drive/MyDrive/Datasets/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>FIles content:</p>
<ul class="simple">
<li><p>proust3: la prigioniera, tutto in paper</p></li>
<li><p>proust4: la fuggitiva, tutto in ebook</p></li>
<li><p>Proust: un po’ nome dei paesi Vol2, merged for all others</p></li>
</ul>
<p>To do:</p>
<ul class="simple">
<li><p>sistemare proust2</p></li>
<li><p>creare generatore date</p></li>
<li><p>creare generatore pagine</p></li>
<li><p>mettere tutto in csv</p></li>
</ul>
</div>
<div class="section" id="dates-generators">
<h1>Dates Generators<a class="headerlink" href="#dates-generators" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">## inclusive</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now make the generator for random walk</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span> <span class="o">=</span> <span class="mi">551</span><span class="o">-</span><span class="mi">103</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>448
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149.33333333333334
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate poisson. N elements, with mean mu</span>
<span class="n">ss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">ss</span><span class="o">-</span><span class="mi">448</span><span class="p">:</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
  <span class="n">ss</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum is </span><span class="si">{</span><span class="n">ss</span><span class="o">-</span><span class="mi">448</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum is -24
Sum is 4
Sum is 43
Sum is 37
Sum is 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5, 3, 5, 1, 3, 3, 7, 4, 0, 5, 6, 1, 2, 4, 2, 0, 3, 1, 3, 3, 0, 2,
       3, 4, 3, 4, 1, 1, 2, 4, 2, 3, 3, 2, 4, 7, 1, 4, 2, 3, 3, 3, 1, 5,
       2, 3, 3, 2, 2, 5, 4, 1, 5, 1, 1, 4, 3, 5, 7, 6, 8, 4, 2, 1, 5, 2,
       3, 2, 3, 0, 2, 3, 2, 4, 2, 3, 5, 1, 3, 2, 1, 3, 4, 0, 1, 3, 4, 5,
       2, 2, 5, 2, 2, 3, 6, 2, 2, 3, 5, 2, 1, 2, 3, 1, 0, 5, 6, 3, 2, 5,
       3, 3, 5, 4, 3, 4, 4, 3, 4, 3, 3, 1, 2, 4, 5, 1, 2, 2, 2, 4, 5, 4,
       3, 4, 1, 4, 7, 2, 2, 3, 5, 4, 2, 2, 3, 3, 2, 1, 3, 2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>448
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="single-volumes-file-preparation">
<h1>Single Volumes file preparation<a class="headerlink" href="#single-volumes-file-preparation" title="Permalink to this headline">#</a></h1>
<div class="section" id="vol1">
<h2>Vol1<a class="headerlink" href="#vol1" title="Permalink to this headline">#</a></h2>
<p>Only final date: 20/5/2018</p>
<p>Probably started in 2017, let’s say in June</p>
<p>p103-551</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="c1">## inclusive</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now make the generator for random walk</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span> <span class="o">=</span> <span class="mi">551</span><span class="o">-</span><span class="mi">103</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>448
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">npages</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>149.33333333333334
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate poisson. N elements, with mean mu</span>
<span class="n">days_read</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">ss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">ss</span><span class="o">-</span><span class="mi">448</span><span class="p">:</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">days_read</span><span class="p">)</span>
  <span class="n">ss</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum is </span><span class="si">{</span><span class="n">ss</span><span class="o">-</span><span class="mi">448</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum is -12
Sum is 1
Sum is -14
Sum is 4
Sum is 29
Sum is 17
Sum is 49
Sum is 14
Sum is -3
Sum is -9
Sum is 6
Sum is 6
Sum is 26
Sum is -33
Sum is 7
Sum is -11
Sum is -29
Sum is -34
Sum is -21
Sum is 18
Sum is 24
Sum is 29
Sum is -9
Sum is 45
Sum is 33
Sum is 17
Sum is 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 5, 1, 8, 3, 3, 3, 1, 1, 4, 7, 1, 4, 3, 5, 2, 4, 1, 1, 4, 4, 4,
       2, 3, 1, 1, 3, 0, 2, 3, 6, 5, 5, 2, 2, 2, 3, 1, 7, 5, 4, 4, 1, 1,
       3, 2, 6, 4, 2, 5, 3, 1, 5, 3, 1, 4, 3, 3, 2, 4, 3, 5, 1, 4, 2, 1,
       2, 3, 5, 2, 0, 7, 2, 4, 3, 1, 3, 3, 2, 3, 2, 5, 7, 3, 1, 7, 4, 0,
       1, 0, 4, 1, 4, 2, 6, 2, 3, 5, 2, 2, 3, 5, 3, 4, 4, 2, 1, 4, 2, 6,
       6, 2, 2, 1, 4, 3, 4, 3, 2, 3, 1, 0, 1, 4, 6, 4, 1, 2, 2, 2, 2, 8,
       0, 2, 5, 4, 6, 0, 2, 3, 2, 6, 2, 2, 1, 6, 4, 2, 1, 0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>448
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create number of zeros</span>
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="p">)</span>

<span class="c1">## merge with a</span>
<span class="c1">#page_read = np.random.shuffle(np.append(a, zz))\</span>

<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>344
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">page_read</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2., 0., 0., 0., 0., 0., 0., 0., 0., 3., 0., 0., 0., 7., 0., 0., 0.,
       0., 2., 4., 0., 0., 0., 0., 0., 0., 5., 0., 0., 1., 2., 1., 0., 0.,
       0., 4., 0., 0., 2., 1., 0., 0., 2., 3., 2., 1., 0., 0., 0., 0., 4.,
       3., 4., 0., 0., 1., 0., 4., 1., 2., 3., 0., 0., 4., 0., 0., 0., 2.,
       3., 0., 5., 2., 0., 7., 0., 0., 4., 4., 3., 0., 0., 3., 0., 6., 0.,
       2., 0., 0., 3., 3., 0., 0., 4., 0., 0., 0., 0., 4., 7., 0., 0., 0.,
       4., 0., 0., 0., 2., 0., 0., 0., 2., 5., 0., 3., 0., 1., 0., 2., 0.,
       0., 5., 0., 4., 2., 7., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
       0., 1., 0., 0., 0., 3., 0., 8., 3., 0., 6., 0., 0., 3., 0., 0., 0.,
       6., 0., 0., 0., 3., 0., 2., 2., 0., 3., 2., 0., 0., 0., 3., 0., 3.,
       0., 0., 0., 2., 0., 4., 0., 4., 2., 0., 0., 5., 2., 4., 1., 3., 3.,
       0., 0., 0., 0., 0., 0., 6., 0., 0., 0., 3., 0., 0., 0., 1., 5., 0.,
       0., 0., 2., 0., 0., 6., 0., 0., 0., 1., 1., 0., 0., 0., 2., 0., 0.,
       0., 0., 1., 0., 2., 0., 0., 3., 0., 0., 0., 6., 0., 0., 0., 2., 2.,
       0., 0., 3., 0., 1., 0., 4., 0., 0., 0., 8., 1., 1., 0., 4., 0., 0.,
       3., 1., 0., 0., 0., 5., 0., 0., 0., 5., 0., 1., 0., 0., 4., 4., 4.,
       0., 0., 5., 6., 3., 0., 4., 3., 0., 2., 1., 0., 0., 7., 0., 1., 1.,
       5., 3., 0., 0., 0., 6., 0., 0., 2., 0., 4., 2., 0., 1., 0., 4., 0.,
       2., 0., 0., 0., 4., 2., 0., 0., 0., 5., 2., 0., 0., 0., 5., 0., 0.,
       0., 0., 0., 0., 0., 3., 0., 0., 4., 0., 2., 5., 0., 0., 1., 2., 0.,
       3., 2., 1., 6.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  2.,   2.,   2.,   2.,   2.,   2.,   2.,   2.,   2.,   5.,   5.,
         5.,   5.,  12.,  12.,  12.,  12.,  12.,  14.,  18.,  18.,  18.,
        18.,  18.,  18.,  18.,  23.,  23.,  23.,  24.,  26.,  27.,  27.,
        27.,  27.,  31.,  31.,  31.,  33.,  34.,  34.,  34.,  36.,  39.,
        41.,  42.,  42.,  42.,  42.,  42.,  46.,  49.,  53.,  53.,  53.,
        54.,  54.,  58.,  59.,  61.,  64.,  64.,  64.,  68.,  68.,  68.,
        68.,  70.,  73.,  73.,  78.,  80.,  80.,  87.,  87.,  87.,  91.,
        95.,  98.,  98.,  98., 101., 101., 107., 107., 109., 109., 109.,
       112., 115., 115., 115., 119., 119., 119., 119., 119., 123., 130.,
       130., 130., 130., 134., 134., 134., 134., 136., 136., 136., 136.,
       138., 143., 143., 146., 146., 147., 147., 149., 149., 149., 154.,
       154., 158., 160., 167., 167., 168., 168., 169., 169., 169., 169.,
       169., 169., 169., 169., 169., 170., 170., 170., 170., 173., 173.,
       181., 184., 184., 190., 190., 190., 193., 193., 193., 193., 199.,
       199., 199., 199., 202., 202., 204., 206., 206., 209., 211., 211.,
       211., 211., 214., 214., 217., 217., 217., 217., 219., 219., 223.,
       223., 227., 229., 229., 229., 234., 236., 240., 241., 244., 247.,
       247., 247., 247., 247., 247., 247., 253., 253., 253., 253., 256.,
       256., 256., 256., 257., 262., 262., 262., 262., 264., 264., 264.,
       270., 270., 270., 270., 271., 272., 272., 272., 272., 274., 274.,
       274., 274., 274., 275., 275., 277., 277., 277., 280., 280., 280.,
       280., 286., 286., 286., 286., 288., 290., 290., 290., 293., 293.,
       294., 294., 298., 298., 298., 298., 306., 307., 308., 308., 312.,
       312., 312., 315., 316., 316., 316., 316., 321., 321., 321., 321.,
       326., 326., 327., 327., 327., 331., 335., 339., 339., 339., 344.,
       350., 353., 353., 357., 360., 360., 362., 363., 363., 363., 370.,
       370., 371., 372., 377., 380., 380., 380., 380., 386., 386., 386.,
       388., 388., 392., 394., 394., 395., 395., 399., 399., 401., 401.,
       401., 401., 405., 407., 407., 407., 407., 412., 414., 414., 414.,
       414., 419., 419., 419., 419., 419., 419., 419., 419., 422., 422.,
       422., 426., 426., 428., 433., 433., 433., 434., 436., 436., 439.,
       441., 442., 448.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">pp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dd</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Results saved in <code class="docutils literal notranslate"><span class="pre">proust01.txt</span></code></p>
</div>
<div class="section" id="vol2">
<h2>Vol2<a class="headerlink" href="#vol2" title="Permalink to this headline">#</a></h2>
<p>p21-571</p>
<p>200: 8-7-18<br />
300: 15/8/18<br />
400: 3/10/18<br />
500: 30-11-18<br />
end: 31/12/18</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="c1">## inclusive</span>



<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="c1">#for i in ll:</span>
<span class="c1">#    print(f&#39;{i},&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#len(ll)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">npages</span> <span class="o">=</span> <span class="mi">100</span><span class="o">-</span><span class="n">offset</span>

<span class="n">npages</span><span class="o">/</span><span class="mi">3</span>
<span class="c1"># generate poisson. N elements, with mean mu</span>
<span class="n">page_a_day</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">days_read</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">page_a_day</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="p">:</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">days_read</span><span class="p">,</span> <span class="n">days_read</span><span class="p">)</span>
  <span class="n">ss</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum is </span><span class="si">{</span><span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># create number of zeros</span>
<span class="n">zeros_to_add</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zeros added: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="si">}</span><span class="s1"> and nozero is </span><span class="si">{</span><span class="n">days_read</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="p">)</span>

<span class="c1">## merge with a</span>

<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;total length page array </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span><span class="si">}</span><span class="s1"> and it has to be </span><span class="si">{</span><span class="n">npages</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

<span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">pp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()):</span>
  <span class="n">off</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">off</span> <span class="o">=</span> <span class="mi">379</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dd</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span><span class="o">+</span><span class="n">off</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from 1109-1231</span>
<span class="n">aa</span> <span class="o">=</span> <span class="p">[</span><span class="mi">437</span><span class="p">,</span>
      <span class="mi">437</span><span class="p">,</span>
<span class="mi">449</span><span class="p">,</span>
<span class="mi">449</span><span class="p">,</span>
<span class="mi">455</span><span class="p">,</span>
<span class="mi">459</span><span class="p">,</span>
<span class="mi">459</span><span class="p">,</span>
<span class="mi">463</span><span class="p">,</span>
<span class="mi">463</span><span class="p">,</span>
<span class="mi">467</span><span class="p">,</span>
<span class="mi">467</span><span class="p">,</span>
<span class="mi">468</span><span class="p">,</span>
<span class="mi">469</span><span class="p">,</span>
<span class="mi">471</span><span class="p">,</span>
<span class="mi">471</span><span class="p">,</span>
<span class="mi">471</span><span class="p">,</span>
<span class="mi">471</span><span class="p">,</span>
<span class="mi">471</span><span class="p">,</span>
<span class="mi">472</span><span class="p">,</span>
<span class="mi">472</span><span class="p">,</span>
<span class="mi">475</span><span class="p">,</span>
<span class="mi">477</span><span class="p">,</span>
<span class="mi">477</span><span class="p">,</span>
<span class="mi">480</span><span class="p">,</span>
<span class="mi">482</span><span class="p">,</span>
<span class="mi">482</span><span class="p">,</span>
<span class="mi">482</span><span class="p">,</span>
<span class="mi">482</span><span class="p">,</span>
<span class="mi">483</span><span class="p">,</span>
<span class="mi">485</span><span class="p">,</span>
<span class="mi">485</span><span class="p">,</span>
<span class="mi">489</span><span class="p">,</span>
<span class="mi">491</span><span class="p">,</span>
<span class="mi">491</span><span class="p">,</span>
<span class="mi">497</span><span class="p">,</span>
<span class="mi">501</span><span class="p">,</span>
<span class="mi">507</span><span class="p">,</span>
<span class="mi">507</span><span class="p">,</span>
<span class="mi">507</span><span class="p">,</span>
<span class="mi">509</span><span class="p">,</span>
<span class="mi">513</span><span class="p">,</span>
<span class="mi">519</span><span class="p">,</span>
<span class="mi">521</span><span class="p">,</span>
<span class="mi">527</span><span class="p">,</span>
<span class="mi">531</span><span class="p">,</span>
<span class="mi">533</span><span class="p">,</span>
<span class="mi">536</span><span class="p">,</span>
<span class="mi">538</span><span class="p">,</span>
<span class="mi">542</span><span class="p">,</span>
<span class="mi">542</span><span class="p">,</span>
<span class="mi">545</span><span class="p">,</span>
<span class="mi">547</span><span class="p">,</span>
<span class="mi">550</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span> <span class="c1">## inclusive</span>



<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="c1">#for i in ll:</span>
<span class="c1">#    print(f&#39;{i},&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">aa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="n">aa</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2018-11-09,437
2018-11-10,437
2018-11-11,449
2018-11-12,449
2018-11-13,455
2018-11-14,459
2018-11-15,459
2018-11-16,463
2018-11-17,463
2018-11-18,467
2018-11-19,467
2018-11-20,468
2018-11-21,469
2018-11-22,471
2018-11-23,471
2018-11-24,471
2018-11-25,471
2018-11-26,471
2018-11-27,472
2018-11-28,472
2018-11-29,475
2018-11-30,477
2018-12-01,477
2018-12-02,480
2018-12-03,482
2018-12-04,482
2018-12-05,482
2018-12-06,482
2018-12-07,483
2018-12-08,485
2018-12-09,485
2018-12-10,489
2018-12-11,491
2018-12-12,491
2018-12-13,497
2018-12-14,501
2018-12-15,507
2018-12-16,507
2018-12-17,507
2018-12-18,509
2018-12-19,513
2018-12-20,519
2018-12-21,521
2018-12-22,527
2018-12-23,531
2018-12-24,533
2018-12-25,536
2018-12-26,538
2018-12-27,542
2018-12-28,542
2018-12-29,545
2018-12-30,547
2018-12-31,550
</pre></div>
</div>
</div>
</div>
<p>Results saved in <code class="docutils literal notranslate"><span class="pre">proust01.txt</span></code></p>
</div>
<div class="section" id="vol-3">
<h2>Vol 3<a class="headerlink" href="#vol-3" title="Permalink to this headline">#</a></h2>
<p>p 19-659</p>
<p>100: 1/3/2019<br />
200: 4/5<br />
300: 11/6<br />
400: 16/7<br />
500: 10/8<br />
600: 3/10<br />
fine: 14/10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="c1">## inclusive</span>


<span class="n">start</span><span class="o">=</span><span class="n">t0</span>
<span class="n">end</span><span class="o">=</span><span class="n">t1</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="c1">#for i in ll:</span>
<span class="c1">#    print(f&#39;{i},&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#len(ll)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">npages</span> <span class="o">=</span> <span class="mi">59</span><span class="o">-</span><span class="n">offset</span>

<span class="n">npages</span><span class="o">/</span><span class="mi">3</span>
<span class="c1"># generate poisson. N elements, with mean mu</span>
<span class="n">page_a_day</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">days_read</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">page_a_day</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="p">:</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">days_read</span><span class="p">,</span> <span class="n">days_read</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last zero, skip...&#39;</span><span class="p">)</span>
    <span class="k">continue</span> 
  <span class="k">else</span><span class="p">:</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum is </span><span class="si">{</span><span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># create number of zeros</span>
<span class="n">zeros_to_add</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zeros added: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="si">}</span><span class="s1"> and nozero is </span><span class="si">{</span><span class="n">days_read</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="p">)</span>

<span class="c1">## merge with a</span>

<span class="n">bb</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## remove last</span>
<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page_read</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;total length page array </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span><span class="si">}</span><span class="s1"> and it has to be </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

<span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">pp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()):</span>
  <span class="c1">#off = 0</span>
  <span class="n">off</span> <span class="o">=</span> <span class="mi">581</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dd</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span><span class="o">+</span><span class="n">off</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum is -13
Sum is 2
Sum is -4
Sum is 7
Sum is 0
Zeros added: 0 and nozero is 11
total length page array 11 and it has to be 11
[ 5.  3.  6.  7.  5.  2.  7.  6.  7. 10.  1.]
[ 5.  8. 14. 21. 26. 28. 35. 41. 48. 58. 59.]
2019-10-04,586
2019-10-05,589
2019-10-06,595
2019-10-07,602
2019-10-08,607
2019-10-09,609
2019-10-10,616
2019-10-11,622
2019-10-12,629
2019-10-13,639
2019-10-14,640
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vol-4">
<h2>Vol 4<a class="headerlink" href="#vol-4" title="Permalink to this headline">#</a></h2>
<p>p 23-650</p>
<p>100: 30/12<br />
200: 29/2/20<br />
300: 1/4<br />
400: 25/5<br />
500: 20/8<br />
600: 30/9<br />
fine: 13/10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">## inclusive</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="c1">## inclusive</span>


<span class="n">start</span><span class="o">=</span><span class="n">t0</span>
<span class="n">end</span><span class="o">=</span><span class="n">t1</span>

<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="c1">#for i in ll:</span>
<span class="c1">#    print(f&#39;{i},&#39;)</span>
<span class="n">offpage</span> <span class="o">=</span> <span class="mi">577</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#len(ll)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">npages</span> <span class="o">=</span> <span class="mi">50</span><span class="o">-</span><span class="n">offset</span>

<span class="n">npages</span><span class="o">/</span><span class="mi">3</span>
<span class="c1"># generate poisson. N elements, with mean mu</span>
<span class="n">page_a_day</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">days_read</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">page_a_day</span><span class="p">)</span>
<span class="n">ss</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="p">:</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">npages</span><span class="o">/</span><span class="n">days_read</span><span class="p">,</span> <span class="n">days_read</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Last zero, skip...&#39;</span><span class="p">)</span>
    <span class="k">continue</span> 
  <span class="k">else</span><span class="p">:</span>
    <span class="n">ss</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum is </span><span class="si">{</span><span class="n">ss</span><span class="o">-</span><span class="n">npages</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># create number of zeros</span>
<span class="n">zeros_to_add</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Zeros added: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="si">}</span><span class="s1"> and nozero is </span><span class="si">{</span><span class="n">days_read</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> 
<span class="n">zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="o">-</span><span class="n">days_read</span><span class="p">)</span>

<span class="c1">## merge with a</span>

<span class="n">bb</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">## remove last</span>
<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">zz</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
<span class="n">page_read</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page_read</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;total length page array </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span><span class="si">}</span><span class="s1"> and it has to be </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">page_read</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

<span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">pp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ll</span><span class="p">,</span><span class="n">page_read</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()):</span>
  <span class="c1">#off = 0</span>
  <span class="n">off</span> <span class="o">=</span> <span class="n">offpage</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dd</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span><span class="o">+</span><span class="n">off</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sum is 4
Sum is 5
Sum is 4
Sum is -9
Sum is -3
Sum is 1
Sum is 6
Sum is -7
Sum is 0
Zeros added: 5 and nozero is 8
total length page array 13 and it has to be 13
[ 2.  9.  0.  0.  2. 10.  0.  5.  6.  0.  9.  0.  7.]
[ 2. 11. 11. 11. 13. 23. 23. 28. 34. 34. 43. 43. 50.]
2020-10-01,579
2020-10-02,588
2020-10-03,588
2020-10-04,588
2020-10-05,590
2020-10-06,600
2020-10-07,600
2020-10-08,605
2020-10-09,611
2020-10-10,611
2020-10-11,620
2020-10-12,620
2020-10-13,627
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vol-5">
<h2>Vol 5<a class="headerlink" href="#vol-5" title="Permalink to this headline">#</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">proust05p.txt</span></code> has already everything.<br />
<strong>BUT</strong> it counts the pages (paper) as they are, i.e. starting with offset.</p>
<p>p 21-487</p>
<p><strong>ALSO</strong> the empty dates need to be filled with previous values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust05p.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-10-14</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-10-15</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-10-16</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-10-17</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-10-18</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-10-19</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-10-20</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-10-21</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-10-22</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-10-23</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020-10-24</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020-10-25</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-10-26</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-10-27</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-10-28</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020-10-29</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020-10-30</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2020-10-31</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2020-11-01</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2020-11-02</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2020-11-03</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2020-11-04</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2020-11-05</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2020-11-06</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2020-11-07</td>
      <td>52.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2020-11-08</td>
      <td>53.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2020-11-09</td>
      <td>53.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2020-11-10</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2020-11-11</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2020-11-12</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">-</span><span class="mi">21</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-10-14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-10-15</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-10-16</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-10-17</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-10-18</td>
      <td>7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2021-04-12</td>
      <td>447</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2021-04-13</td>
      <td>451</td>
    </tr>
    <tr>
      <th>182</th>
      <td>2021-04-14</td>
      <td>460</td>
    </tr>
    <tr>
      <th>183</th>
      <td>2021-04-15</td>
      <td>460</td>
    </tr>
    <tr>
      <th>184</th>
      <td>2021-04-16</td>
      <td>466</td>
    </tr>
  </tbody>
</table>
<p>185 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust05.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vol-6">
<h2>Vol 6<a class="headerlink" href="#vol-6" title="Permalink to this headline">#</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">proust06e.txt</span></code> has everything</p>
<ul class="simple">
<li><p>The pages are from ebbok!!</p></li>
<li><p>there is an offset to account for (maybe when transforming from ebook -&gt; page)</p></li>
</ul>
<p>ebook: 173- 4652
paper: 23-338</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust06e.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-04-17</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-04-18</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-04-19</td>
      <td>274.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-04-20</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-04-21</td>
      <td>354.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2021-06-13</td>
      <td>4232.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2021-06-14</td>
      <td>4354.0</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2021-06-15</td>
      <td>4443.0</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2021-06-16</td>
      <td>4510.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>2021-06-17</td>
      <td>4652.0</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## fill the nan with ff</span>
<span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;dt&#39;, &#39; page&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">173</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-04-17</td>
      <td>173.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-04-18</td>
      <td>234.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-04-19</td>
      <td>274.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-04-20</td>
      <td>304.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-04-21</td>
      <td>354.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## transform the pages in paper pages</span>

<span class="k">def</span> <span class="nf">ebook2page</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="n">x0</span><span class="o">=</span><span class="mi">173</span>
  <span class="n">y0</span><span class="o">=</span><span class="mi">23</span>
  <span class="n">x1</span><span class="o">=</span><span class="mi">4652</span>
  <span class="n">y1</span><span class="o">=</span><span class="mi">338</span>
  <span class="n">m</span><span class="o">=</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>
  <span class="n">y</span><span class="o">=</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">+</span><span class="n">y0</span>

  <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ebook2page</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0,   4,   7,   9,  12,  14,  18,  22,  25,  32,  39,  39,  46,
        54,  54,  59,  59,  65,  69,  77,  81,  88,  94, 101, 108, 115,
       123, 123, 123, 123, 123, 128, 128, 134, 139, 141, 145, 150, 156,
       162, 168, 176, 183, 188, 195, 204, 208, 216, 226, 233, 239, 243,
       252, 261, 269, 277, 285, 294, 300, 305, 315])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">ebook2page</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">-</span><span class="mi">23</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-04-17</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-04-18</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-04-19</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-04-20</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-04-21</td>
      <td>12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2021-06-13</td>
      <td>285</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2021-06-14</td>
      <td>294</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2021-06-15</td>
      <td>300</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2021-06-16</td>
      <td>305</td>
    </tr>
    <tr>
      <th>60</th>
      <td>2021-06-17</td>
      <td>315</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust06e.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vol-7">
<h2>Vol 7<a class="headerlink" href="#vol-7" title="Permalink to this headline">#</a></h2>
<p>The file <code class="docutils literal notranslate"><span class="pre">proust07p.txt</span></code> has already everything.<br />
<strong>BUT</strong> it counts the pages (paper) as they are, i.e. starting with offset.</p>
<p>p 19-468</p>
<p><strong>ALSO</strong> the empty dates need to be filled with previous values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust7p_tmp.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-18</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-19</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-20</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-21</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-22</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021-06-23</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2021-06-24</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2021-06-25</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2021-06-26</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2021-06-27</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2021-06-28</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2021-06-29</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2021-06-30</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2021-07-01</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2021-07-02</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021-07-03</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2021-07-04</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2021-07-05</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2021-07-06</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2021-07-07</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2021-07-08</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2021-07-09</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2021-07-10</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2021-07-11</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2021-07-12</td>
      <td>61.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2021-07-13</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2021-07-14</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2021-07-15</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2021-07-16</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2021-07-17</td>
      <td>95.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">-</span><span class="mi">19</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">page</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">page</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-18</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-09-16</td>
      <td>404</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-09-17</td>
      <td>411</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-09-18</td>
      <td>425</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-09-19</td>
      <td>435</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-09-20</td>
      <td>449</td>
    </tr>
  </tbody>
</table>
<p>95 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust07.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-and-transform-volumes">
<h2>Load and transform volumes<a class="headerlink" href="#load-and-transform-volumes" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust01.txt&#39;</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-06-11</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-06-12</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-06-13</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-06-14</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-06-15</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>2018-05-16</td>
      <td>436</td>
    </tr>
    <tr>
      <th>340</th>
      <td>2018-05-17</td>
      <td>439</td>
    </tr>
    <tr>
      <th>341</th>
      <td>2018-05-18</td>
      <td>441</td>
    </tr>
    <tr>
      <th>342</th>
      <td>2018-05-19</td>
      <td>442</td>
    </tr>
    <tr>
      <th>343</th>
      <td>2018-05-20</td>
      <td>448</td>
    </tr>
  </tbody>
</table>
<p>344 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust02.txt&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-05-21</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-05-22</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-05-23</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-05-24</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-05-25</td>
      <td>16</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>220</th>
      <td>2018-12-27</td>
      <td>542</td>
    </tr>
    <tr>
      <th>221</th>
      <td>2018-12-28</td>
      <td>542</td>
    </tr>
    <tr>
      <th>222</th>
      <td>2018-12-29</td>
      <td>545</td>
    </tr>
    <tr>
      <th>223</th>
      <td>2018-12-30</td>
      <td>547</td>
    </tr>
    <tr>
      <th>224</th>
      <td>2018-12-31</td>
      <td>550</td>
    </tr>
  </tbody>
</table>
<p>225 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust03.txt&#39;</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-02</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-03</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-04</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-05</td>
      <td>7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>282</th>
      <td>2019-10-10</td>
      <td>616</td>
    </tr>
    <tr>
      <th>283</th>
      <td>2019-10-11</td>
      <td>622</td>
    </tr>
    <tr>
      <th>284</th>
      <td>2019-10-12</td>
      <td>629</td>
    </tr>
    <tr>
      <th>285</th>
      <td>2019-10-13</td>
      <td>639</td>
    </tr>
    <tr>
      <th>286</th>
      <td>2019-10-14</td>
      <td>640</td>
    </tr>
  </tbody>
</table>
<p>287 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust04.txt&#39;</span><span class="p">)</span>
<span class="n">df4</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;page&#39;</span><span class="p">]</span>
<span class="n">df4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-10-15</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-10-16</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-10-17</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-10-18</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-10-19</td>
      <td>4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>360</th>
      <td>2020-10-09</td>
      <td>611</td>
    </tr>
    <tr>
      <th>361</th>
      <td>2020-10-10</td>
      <td>611</td>
    </tr>
    <tr>
      <th>362</th>
      <td>2020-10-11</td>
      <td>620</td>
    </tr>
    <tr>
      <th>363</th>
      <td>2020-10-12</td>
      <td>620</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2020-10-13</td>
      <td>627</td>
    </tr>
  </tbody>
</table>
<p>365 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust05.csv&#39;</span><span class="p">)</span>
<span class="c1">#df5.columns = [&#39;dt&#39;, &#39;page&#39;]</span>
<span class="n">df5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-10-14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-10-15</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-10-16</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-10-17</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-10-18</td>
      <td>7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2021-04-12</td>
      <td>447</td>
    </tr>
    <tr>
      <th>181</th>
      <td>2021-04-13</td>
      <td>451</td>
    </tr>
    <tr>
      <th>182</th>
      <td>2021-04-14</td>
      <td>460</td>
    </tr>
    <tr>
      <th>183</th>
      <td>2021-04-15</td>
      <td>460</td>
    </tr>
    <tr>
      <th>184</th>
      <td>2021-04-16</td>
      <td>466</td>
    </tr>
  </tbody>
</table>
<p>185 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust06e.csv&#39;</span><span class="p">)</span>
<span class="c1">#df5.columns = [&#39;dt&#39;, &#39;page&#39;]</span>
<span class="n">df6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-04-17</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-04-18</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-04-19</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-04-20</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-04-21</td>
      <td>12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2021-06-13</td>
      <td>285</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2021-06-14</td>
      <td>294</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2021-06-15</td>
      <td>300</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2021-06-16</td>
      <td>305</td>
    </tr>
    <tr>
      <th>60</th>
      <td>2021-06-17</td>
      <td>315</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust07.csv&#39;</span><span class="p">)</span>
<span class="c1">#df5.columns = [&#39;dt&#39;, &#39;page&#39;]</span>
<span class="n">df7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-18</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-19</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-09-16</td>
      <td>404</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-09-17</td>
      <td>411</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-09-18</td>
      <td>425</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-09-19</td>
      <td>435</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-09-20</td>
      <td>449</td>
    </tr>
  </tbody>
</table>
<p>95 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">,</span> <span class="n">df5</span><span class="p">,</span> <span class="n">df6</span><span class="p">,</span> <span class="n">df7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We need to add the total pages, that is given by the very last row.<br />
We store it in a <code class="docutils literal notranslate"><span class="pre">vol_offset</span></code>
We need an extra entry at the beginnning</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_offset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_arr</span><span class="p">:</span>
  <span class="n">ll</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">vol_offset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_offset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 448, 550, 640, 627, 466, 315, 449]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## calculate the cumsum()</span>
<span class="n">vol_offset_cum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vol_offset</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_offset_cum</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,  448,  998, 1638, 2265, 2731, 3046, 3495])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_arr2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">## add offset</span>
<span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">off</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_arr</span><span class="p">,</span> <span class="n">vol_offset_cum</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
  <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">page</span> <span class="o">+</span> <span class="n">off</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-18</td>
      <td>0</td>
      <td>3046</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-19</td>
      <td>0</td>
      <td>3046</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-20</td>
      <td>0</td>
      <td>3046</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-21</td>
      <td>0</td>
      <td>3046</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-22</td>
      <td>0</td>
      <td>3046</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-09-16</td>
      <td>404</td>
      <td>3450</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-09-17</td>
      <td>411</td>
      <td>3457</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-09-18</td>
      <td>425</td>
      <td>3471</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-09-19</td>
      <td>435</td>
      <td>3481</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-09-20</td>
      <td>449</td>
      <td>3495</td>
    </tr>
  </tbody>
</table>
<p>95 rows × 3 columns</p>
</div></div></div>
</div>
<p>OK it worked as the first entry has the correct offset.</p>
<p>Let’s check another one that has first page &gt; 0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="c1">##offset should be 998</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01</td>
      <td>3</td>
      <td>1001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-02</td>
      <td>3</td>
      <td>1001</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-03</td>
      <td>3</td>
      <td>1001</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-04</td>
      <td>3</td>
      <td>1001</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-05</td>
      <td>7</td>
      <td>1005</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>282</th>
      <td>2019-10-10</td>
      <td>616</td>
      <td>1614</td>
    </tr>
    <tr>
      <th>283</th>
      <td>2019-10-11</td>
      <td>622</td>
      <td>1620</td>
    </tr>
    <tr>
      <th>284</th>
      <td>2019-10-12</td>
      <td>629</td>
      <td>1627</td>
    </tr>
    <tr>
      <th>285</th>
      <td>2019-10-13</td>
      <td>639</td>
      <td>1637</td>
    </tr>
    <tr>
      <th>286</th>
      <td>2019-10-14</td>
      <td>640</td>
      <td>1638</td>
    </tr>
  </tbody>
</table>
<p>287 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-06-11</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-06-12</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-06-13</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-06-14</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-06-15</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>339</th>
      <td>2018-05-16</td>
      <td>436</td>
      <td>436</td>
    </tr>
    <tr>
      <th>340</th>
      <td>2018-05-17</td>
      <td>439</td>
      <td>439</td>
    </tr>
    <tr>
      <th>341</th>
      <td>2018-05-18</td>
      <td>441</td>
      <td>441</td>
    </tr>
    <tr>
      <th>342</th>
      <td>2018-05-19</td>
      <td>442</td>
      <td>442</td>
    </tr>
    <tr>
      <th>343</th>
      <td>2018-05-20</td>
      <td>448</td>
      <td>448</td>
    </tr>
  </tbody>
</table>
<p>344 rows × 3 columns</p>
</div></div></div>
</div>
<p>I want now to add a column with the Volume Number, 1 to 7</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_number</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="n">vol_number</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5, 6, 7]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## add volume name</span>
<span class="k">for</span> <span class="n">dd</span><span class="p">,</span><span class="n">v_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df_arr</span><span class="p">,</span> <span class="n">vol_number</span><span class="p">):</span>
  <span class="n">dd</span><span class="p">[</span><span class="s1">&#39;Vol_Num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_i</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
      <th>Vol_Num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021-06-18</td>
      <td>0</td>
      <td>3046</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2021-06-19</td>
      <td>0</td>
      <td>3046</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2021-06-20</td>
      <td>0</td>
      <td>3046</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2021-06-21</td>
      <td>0</td>
      <td>3046</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021-06-22</td>
      <td>0</td>
      <td>3046</td>
      <td>7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-09-16</td>
      <td>404</td>
      <td>3450</td>
      <td>7</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-09-17</td>
      <td>411</td>
      <td>3457</td>
      <td>7</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-09-18</td>
      <td>425</td>
      <td>3471</td>
      <td>7</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-09-19</td>
      <td>435</td>
      <td>3481</td>
      <td>7</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-09-20</td>
      <td>449</td>
      <td>3495</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>95 rows × 4 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="make-the-combined-dataset-and-save">
<h1>Make the combined dataset and save<a class="headerlink" href="#make-the-combined-dataset-and-save" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Put eveything together</span>
<span class="n">df_tot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
      <th>Vol_Num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-06-11</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-06-12</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-06-13</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-06-14</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-06-15</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2021-09-16</td>
      <td>404</td>
      <td>3450</td>
      <td>7</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2021-09-17</td>
      <td>411</td>
      <td>3457</td>
      <td>7</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2021-09-18</td>
      <td>425</td>
      <td>3471</td>
      <td>7</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2021-09-19</td>
      <td>435</td>
      <td>3481</td>
      <td>7</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2021-09-20</td>
      <td>449</td>
      <td>3495</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>1562 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tot</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust_final.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-meta-df-with-generic-info-on-all-volumes">
<h1>Make meta-df with generic info on all volumes<a class="headerlink" href="#make-meta-df-with-generic-info-on-all-volumes" title="Permalink to this headline">#</a></h1>
<p>Let’s create a vector with first date of the volume, and another with the last
date (that should be -1 of the first on next volume)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date_vol</span> <span class="o">=</span> <span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">df_arr</span><span class="p">]</span>
<span class="n">start_date_vol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2017-06-11&#39;,
 &#39;2018-05-21&#39;,
 &#39;2019-01-01&#39;,
 &#39;2019-10-15&#39;,
 &#39;2020-10-14&#39;,
 &#39;2021-04-17&#39;,
 &#39;2021-06-18&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">end_date_vol</span> <span class="o">=</span> <span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">df_arr</span><span class="p">]</span>
<span class="n">end_date_vol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2018-05-20&#39;,
 &#39;2018-12-31&#39;,
 &#39;2019-10-14&#39;,
 &#39;2020-10-13&#39;,
 &#39;2021-04-16&#39;,
 &#39;2021-06-17&#39;,
 &#39;2021-09-20&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_number</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="n">df_meta</span><span class="p">[</span><span class="s2">&quot;Vol_Num&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol_number</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Start_dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_date_vol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;End_dt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_date_vol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol_offset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 448, 550, 640, 627, 466, 315, 449]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## put number of page of each Volumes</span>
<span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Vol_pages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol_offset</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Put Titles</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;In Search of Lost Time&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Swann Way&#39;</span><span class="p">,</span> 
          <span class="s1">&#39;In the Shadow of Young Girls in Flower&#39;</span><span class="p">,</span>
     <span class="s1">&#39;The Guermantes Way&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sodom and Gomorrah&#39;</span><span class="p">,</span>
    <span class="s1">&#39;The Prisoner&#39;</span><span class="p">,</span>
    <span class="s1">&#39;The Fugitive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Time Regained&#39;</span><span class="p">]</span>
<span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Vol_Num</th>
      <th>Start_dt</th>
      <th>End_dt</th>
      <th>Vol_pages</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2017-06-11</td>
      <td>2018-05-20</td>
      <td>448</td>
      <td>Swann Way</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2018-05-21</td>
      <td>2018-12-31</td>
      <td>550</td>
      <td>In the Shadow of Young Girls in Flower</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2019-01-01</td>
      <td>2019-10-14</td>
      <td>640</td>
      <td>The Guermantes Way</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2019-10-15</td>
      <td>2020-10-13</td>
      <td>627</td>
      <td>Sodom and Gomorrah</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2020-10-14</td>
      <td>2021-04-16</td>
      <td>466</td>
      <td>The Prisoner</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>2021-04-17</td>
      <td>2021-06-17</td>
      <td>315</td>
      <td>The Fugitive</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>2021-06-18</td>
      <td>2021-09-20</td>
      <td>449</td>
      <td>Time Regained</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tot_page</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span>   <span class="ow">in</span> <span class="n">df_meta</span><span class="o">.</span><span class="n">Vol_pages</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">():</span>
  <span class="n">tot_page</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">tot_page</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 448, 998, 1638, 2265, 2731, 3046, 3495]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Add the total pages</span>
<span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Tot_pages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_page</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Vol_Num</th>
      <th>Start_dt</th>
      <th>End_dt</th>
      <th>Vol_pages</th>
      <th>Title</th>
      <th>Tot_pages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2017-06-11</td>
      <td>2018-05-20</td>
      <td>448</td>
      <td>Swann Way</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2018-05-21</td>
      <td>2018-12-31</td>
      <td>550</td>
      <td>In the Shadow of Young Girls in Flower</td>
      <td>448</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2019-01-01</td>
      <td>2019-10-14</td>
      <td>640</td>
      <td>The Guermantes Way</td>
      <td>998</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2019-10-15</td>
      <td>2020-10-13</td>
      <td>627</td>
      <td>Sodom and Gomorrah</td>
      <td>1638</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2020-10-14</td>
      <td>2021-04-16</td>
      <td>466</td>
      <td>The Prisoner</td>
      <td>2265</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>2021-04-17</td>
      <td>2021-06-17</td>
      <td>315</td>
      <td>The Fugitive</td>
      <td>2731</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>2021-06-18</td>
      <td>2021-09-20</td>
      <td>449</td>
      <td>Time Regained</td>
      <td>3046</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust_meta_final.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="make-the-plot">
<h1>Make The Plot<a class="headerlink" href="#make-the-plot" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">DateFormatter</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust_final.csv&#39;</span><span class="p">)</span>
<span class="n">df_meta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;proust_meta_final.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;dt&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dt</th>
      <th>page</th>
      <th>tot</th>
      <th>Vol_Num</th>
    </tr>
    <tr>
      <th>dt</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-06-11</th>
      <td>2017-06-11</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-06-12</th>
      <td>2017-06-12</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-06-13</th>
      <td>2017-06-13</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-06-14</th>
      <td>2017-06-14</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2017-06-15</th>
      <td>2017-06-15</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2021-09-16</th>
      <td>2021-09-16</td>
      <td>404</td>
      <td>3450</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2021-09-17</th>
      <td>2021-09-17</td>
      <td>411</td>
      <td>3457</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2021-09-18</th>
      <td>2021-09-18</td>
      <td>425</td>
      <td>3471</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2021-09-19</th>
      <td>2021-09-19</td>
      <td>435</td>
      <td>3481</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2021-09-20</th>
      <td>2021-09-20</td>
      <td>449</td>
      <td>3495</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>1562 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;2017-06-11&#39;, &#39;2017-06-12&#39;, &#39;2017-06-13&#39;, ..., &#39;2021-09-18&#39;,
       &#39;2021-09-19&#39;, &#39;2021-09-20&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">tot</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fde93d201d0&gt;
</pre></div>
</div>
<img alt="../../../_images/88e1ea19093f997b622b4edb511b4edd3e8dd0216da1b82af8dd611b3edc9760.png" src="../../../_images/88e1ea19093f997b622b4edb511b4edd3e8dd0216da1b82af8dd611b3edc9760.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#last_row = [7, &#39;2021-06-18&#39;, &#39;2021-09-21&#39;, 451, &#39;Time Regained&#39;]</span>

<span class="c1">## create dfadd</span>
<span class="c1">#df_extra = pd.DataFrame(np.array([last_row]), columns = df_meta.columns)</span>

<span class="c1">#df_meta = pd.concat([df_meta, df_extra], axis=0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Vol_Num</th>
      <th>Start_dt</th>
      <th>End_dt</th>
      <th>Vol_pages</th>
      <th>Title</th>
      <th>Tot_pages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2017-06-11</td>
      <td>2018-05-20</td>
      <td>448</td>
      <td>Swann Way</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2018-05-21</td>
      <td>2018-12-31</td>
      <td>550</td>
      <td>In the Shadow of Young Girls in Flower</td>
      <td>448</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2019-01-01</td>
      <td>2019-10-14</td>
      <td>640</td>
      <td>The Guermantes Way</td>
      <td>998</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2019-10-15</td>
      <td>2020-10-13</td>
      <td>627</td>
      <td>Sodom and Gomorrah</td>
      <td>1638</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2020-10-14</td>
      <td>2021-04-16</td>
      <td>466</td>
      <td>The Prisoner</td>
      <td>2265</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>2021-04-17</td>
      <td>2021-06-17</td>
      <td>315</td>
      <td>The Fugitive</td>
      <td>2731</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>2021-06-18</td>
      <td>2021-09-23</td>
      <td>449</td>
      <td>Time Regained</td>
      <td>3046</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Start_dt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2017-06-11&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
    <span class="c1"># Based on &quot;Stove Ownership&quot; from XKCD by Randall Monroe</span>
    <span class="c1"># http://xkcd.com/418/</span>

    <span class="c1"># Some other good examples: </span>
    <span class="c1"># https://jakevdp.github.io/blog/2012/10/07/xkcd-style-plots-in-matplotlib/</span>
    <span class="c1"># https://matplotlib.org/xkcd/gallery.html</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="c1">#plt.xticks([])</span>
    <span class="c1">#plt.yticks([])</span>
    <span class="c1">#ax.set_ylim([-30, 10])</span>

    <span class="c1">#data = np.ones(100)</span>
    <span class="c1">#data[70:] -= np.arange(30)</span>

    <span class="c1">#plt.annotate(</span>
    <span class="c1">#    &#39;THE DAY I REALIZED\nI COULD COOK BACON\nWHENEVER I WANTED&#39;,</span>
    <span class="c1">#    xy=(70, 1), arrowprops=dict(arrowstyle=&#39;-&gt;&#39;), xytext=(15, -10))</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">tot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1">## plot volume lines and name</span>
    <span class="n">title_x_positions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2019-08-01&#39;</span><span class="p">,</span><span class="s1">&#39;2018-12-01&#39;</span><span class="p">,</span><span class="s1">&#39;2019-08-01&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;2017-07-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-07-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-07-01&#39;</span><span class="p">,</span><span class="s1">&#39;2017-07-01&#39;</span><span class="p">]</span>
    <span class="n">prefix_title</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Vol I: &#39;</span><span class="p">,</span> <span class="s1">&#39;Vol II: &#39;</span><span class="p">,</span><span class="s1">&#39;Vol III: &#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Vol IV: &#39;</span><span class="p">,</span><span class="s1">&#39;Vol V: &#39;</span><span class="p">,</span><span class="s1">&#39;Vol VI: &#39;</span><span class="p">,</span><span class="s1">&#39;Vol VII: &#39;</span><span class="p">]</span>
    <span class="c1">#x = df_meta[&#39;Start_dt&#39;].values[0]</span>
    <span class="c1">#</span>
    <span class="c1">#plt.plot([&#39;2017-07-01&#39;, &#39;2021-07-01&#39;], [500, 500], &#39;k-&#39;, lw=2)</span>
    <span class="c1">#ax.annotate(&quot;test&quot;, xy=(&#39;2017-07-01&#39;,600))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
      <span class="n">y</span> <span class="o">=</span> <span class="n">df_meta</span><span class="p">[</span><span class="s1">&#39;Tot_pages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">name</span> <span class="o">=</span> <span class="n">prefix_title</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">df_meta</span><span class="o">.</span><span class="n">Title</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">title_x_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="o">+</span><span class="mi">50</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
   
    <span class="n">y</span> <span class="o">=</span> <span class="mi">3495</span>   
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;In Search of Lost Time - The END&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">title_x_positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">y</span><span class="o">+</span><span class="mi">50</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Pages&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">## rotation, etc... </span>
    
    <span class="c1"># Define the date format</span>
    <span class="n">date_form</span> <span class="o">=</span> <span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">date_form</span><span class="p">)</span>
    <span class="c1"># Ensure ticks fall once every other week (interval=2) </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">WeekdayLocator</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">13</span><span class="p">))</span>

    
    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span>
        <span class="s1">&#39;&quot;Stove Ownership&quot; from xkcd by Randall Monroe&#39;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d078f49f7bae40f319856d46e8d6a20c16b363f3a960602dffb07f5bf4b05b09.png" src="../../../_images/d078f49f7bae40f319856d46e8d6a20c16b363f3a960602dffb07f5bf4b05b09.png" />
</div>
</div>
</div>

<div class="section">
   
</div>

            </article>
            
<!-- Add a comment box underneath the page's content -->
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://abocci.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fas fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dates-generators">
   Dates Generators
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#single-volumes-file-preparation">
   Single Volumes file preparation
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol1">
     Vol1
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol2">
     Vol2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol-3">
     Vol 3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol-4">
     Vol 4
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol-5">
     Vol 5
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol-6">
     Vol 6
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vol-7">
     Vol 7
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-transform-volumes">
     Load and transform volumes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-the-combined-dataset-and-save">
   Make the combined dataset and save
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-meta-df-with-generic-info-on-all-volumes">
   Make meta-df with generic info on all volumes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#make-the-plot">
   Make The Plot
  </a>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, Andrea Bocci.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>